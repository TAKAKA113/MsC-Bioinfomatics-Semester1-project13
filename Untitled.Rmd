---
title: "LLM.tutorial"
output: html_document
date: "2025-12-03"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

ChatGPTãŒä½œæˆã—ãŸLinear Mixed Model (LMM) ã®è§£èª¬ã‚’å…ƒã«ã€**R (RStudio) ã‚„ Google Colab ã§ãã®ã¾ã¾å®Ÿè¡Œãƒ»å­¦ç¿’ã§ãã‚‹ã€ŒR Markdownå½¢å¼ã€ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„**ã‚’ä½œæˆã—ã¾ã—ãŸã€‚

å…ƒã®å†…å®¹ã‚’ãƒ™ãƒ¼ã‚¹ã«ã—ã¤ã¤ã€ä»¥ä¸‹ã®**3ã¤ã®å¼·åŒ–**ã‚’è¡Œã£ã¦ã„ã¾ã™ã€‚

1.  **å®Ÿè¡Œå¯èƒ½ãªãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ã®è¿½åŠ **: ã‚³ãƒ¼ãƒ‰ã‚’ãŸã èª­ã‚€ã ã‘ã§ãªãã€å®Ÿéš›ã«å‹•ã‹ã—ã¦æ•°å€¤ã‚’ç¢ºèªã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚
2.  **å›³è§£ï¼ˆãƒ—ãƒ­ãƒƒãƒˆï¼‰ã®è¿½åŠ **: å›ºå®šåŠ¹æœã¨ãƒ©ãƒ³ãƒ€ãƒ åŠ¹æœã®é•ã„ã€BLUEï¼ˆäºˆæ¸¬å€¤ï¼‰ã®æ„å‘³ã‚’è¦–è¦šçš„ã«ç†è§£ã™ã‚‹ãŸã‚ã®ã‚°ãƒ©ãƒ•æç”»ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã—ã¾ã—ãŸã€‚
3.  **ç†è«–çš„è£œè¶³**: çµ±è¨ˆç”¨èªï¼ˆBLUE vs BLUPï¼‰ã®æ­£ç¢ºãªåŒºåˆ¥ã‚„ã€æ•°å¼çš„ãªèƒŒæ™¯ã‚’å°‘ã—è£œè¶³ã—ã¦ç†è§£ã‚’æ·±ã‚ã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚

-----

### Google Colab ã¾ãŸã¯ RStudio ã§ã®ä½¿ã„æ–¹

ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ã®ä¸­èº«ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ã€ç’°å¢ƒã«åˆã‚ã›ã¦ä¿å­˜ãƒ»å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚

  * **RStudioã®å ´åˆ**: `LMM_Tutorial.Rmd` ã¨ã„ã†åå‰ã§ä¿å­˜ã—ã€ã€ŒKnitã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ç¶ºéº—ãªãƒ¬ãƒãƒ¼ãƒˆãŒå‡ºåŠ›ã•ã‚Œã¾ã™ã€‚
  * **Google Colabã®å ´åˆ**: ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã®è¨­å®šã§ã€Œãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã®ã‚¿ã‚¤ãƒ—ã€ã‚’ **R** ã«å¤‰æ›´ã—ã¦ã‹ã‚‰ã€ã‚³ãƒ¼ãƒ‰ã‚»ãƒ«ã«éƒ¨åˆ†ã”ã¨ã«è²¼ã‚Šä»˜ã‘ã¦å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚

-----

### ğŸ“˜ R Markdown ã‚³ãƒ¼ãƒ‰ (ã“ã“ã‹ã‚‰ã‚³ãƒ”ãƒ¼)

````markdown
---
title: "Linear Mixed Models (LMM) å®Ÿè·µã‚¬ã‚¤ãƒ‰"
author: "Generated by Gemini"
date: "`r Sys.Date()`"
output: 
  html_document:
    toc: true
    toc_float: true
    number_sections: true
    theme: flatly
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
# å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¨èª­ã¿è¾¼ã¿
if (!require("lme4")) install.packages("lme4")
if (!require("tidyverse")) install.packages("tidyverse")
if (!require("lmerTest")) install.packages("lmerTest") # på€¤ãªã©ã®è¡¨ç¤ºç”¨

library(lme4)
library(tidyverse)
library(lmerTest)
````

# ã¯ã˜ã‚ã«ï¼šã“ã®ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã®ç›®çš„

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€**Linear Mixed Model (LMM)** ã®æ§‹é€ ã€å›ºå®šåŠ¹æœãƒ»ãƒ©ãƒ³ãƒ€ãƒ åŠ¹æœã®æ„å‘³ã€ãã—ã¦è‚²ç¨®ä¾¡ï¼ˆBLUE/BLUPï¼‰ã®è¨ˆç®—éç¨‹ã‚’ã€Rã®ã‚³ãƒ¼ãƒ‰ã‚’å‹•ã‹ã—ãªãŒã‚‰ç†è§£ã™ã‚‹ãŸã‚ã®ã‚‚ã®ã§ã™ã€‚

# 0\. ãƒ‡ãƒ¼ã‚¿ã®æº–å‚™ï¼ˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰

è§£èª¬ã‚’å‹•ã‹ã™ãŸã‚ã«ã€ä»®æƒ³çš„ãªå®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆã—ã¾ã™ã€‚
**ã‚·ãƒŠãƒªã‚ª**:

  * **Genotype (å“ç¨®)**: 10å“ç¨® (ãƒ©ãƒ³ãƒ€ãƒ åŠ¹æœ)
  * **Location (å ´æ‰€)**: 3ç®‡æ‰€ A, B, C (å›ºå®šåŠ¹æœ)
  * **SPno**: åé‡ã‚„ç‰¹æ€§ãªã©ã®å¿œç­”å¤‰æ•°

<!-- end list -->

```{r create_data}
set.seed(123) # å†ç¾æ€§ã®ãŸã‚ä¹±æ•°ã‚’å›ºå®š

# ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨­å®š
n_genotypes <- 10
n_locations <- 3
reps <- 3 # å„å ´æ‰€ã§ã®ç¹°ã‚Šè¿”ã—æ•°

# ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ä½œæˆ
genotypes <- paste0("Geno_", 1:n_genotypes)
locations <- c("Loc_A", "Loc_B", "Loc_C")

df <- expand.grid(Genotype = genotypes, Location = locations, Rep = 1:reps)

# çœŸã®åŠ¹æœï¼ˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ï¼‰
true_intercept <- 15.8
loc_effects <- c(0, 2.1, -1.5) # A=0(åŸºæº–), B=+2.1, C=-1.5
names(loc_effects) <- locations

# ãƒ©ãƒ³ãƒ€ãƒ åŠ¹æœï¼ˆå“ç¨®ã”ã¨ã®çœŸã®èƒ½åŠ›ï¼‰ã‚’æ­£è¦åˆ†å¸ƒã‹ã‚‰ç”Ÿæˆ
geno_effects <- rnorm(n_genotypes, mean = 0, sd = 2)
names(geno_effects) <- genotypes

# ãƒ‡ãƒ¼ã‚¿ã®ç”Ÿæˆ: y = Intercept + Loc + Geno + Error
df$SPno <- true_intercept + 
           loc_effects[df$Location] + 
           geno_effects[df$Genotype] + 
           rnorm(nrow(df), mean = 0, sd = 1) # æ®‹å·®

# ãƒ‡ãƒ¼ã‚¿ã®ç¢ºèª
head(df)
```

# 1\. LMM ã®åŸºæœ¬æ§‹é€ 

ç·šå½¢æ··åˆãƒ¢ãƒ‡ãƒ«ã®åŸºæœ¬å¼ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚

$$
y_{ij} = \underbrace{\mu + \beta_i}_{\text{å›ºå®šåŠ¹æœ}} + \underbrace{u_j}_{\text{ãƒ©ãƒ³ãƒ€ãƒ åŠ¹æœ}} + \underbrace{\epsilon_{ij}}_{\text{æ®‹å·®}}
$$

  * **å¿œç­”å€¤ ($y_{ij}$)**: è¦³æ¸¬ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ (SPno)
  * **Intercept ($\mu$)**: åŸºæº–ãƒ¬ãƒ™ãƒ«ã®å¹³å‡
  * **å›ºå®šåŠ¹æœ ($\beta_i$)**: ç’°å¢ƒãƒ»å‡¦ç†ã«ã‚ˆã‚‹å·® (Location)
  * **ãƒ©ãƒ³ãƒ€ãƒ åŠ¹æœ ($u_j$)**: å€‹ä½“ãƒ»å“ç¨®ã«ã‚ˆã‚‹å¹³å‡ã‹ã‚‰ã®ã‚ºãƒ¬ (Genotype)
  * **æ®‹å·® ($\epsilon_{ij}$)**: ãƒ¢ãƒ‡ãƒ«ã§èª¬æ˜ã§ããªã„ãƒã‚¤ã‚º

## ãƒ¢ãƒ‡ãƒ«ã®å®Ÿè¡Œ

Rã® `lmer` é–¢æ•°ã‚’ä½¿ã£ã¦è§£æã—ã¾ã™ã€‚

```{r run_model}
# ãƒ¢ãƒ‡ãƒ«å¼: SPno ~ Location + (1 | Genotype)
# (1 | Genotype) ã¯ã€ŒGenotypeã”ã¨ã«åˆ‡ç‰‡ï¼ˆå¹³å‡ï¼‰ãŒãƒ©ãƒ³ãƒ€ãƒ ã«å¤‰å‹•ã™ã‚‹ã€ã¨ã„ã†æ„å‘³
model_tkw <- lmer(SPno ~ Location + (1 | Genotype), data = df)

# çµæœã®è¦ç´„
summary(model_tkw)
```

# 2\. Interceptï¼ˆåˆ‡ç‰‡ï¼‰ã¨ã¯ä½•ã‹ï¼Ÿ

Rã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆé †ã§æœ€åˆã®æ°´æº–ãŒã€ŒåŸºæº– (Reference Level)ã€ã«ãªã‚Šã¾ã™ã€‚

  * ã“ã“ã§ã¯ **Loc\_A** ãŒåŸºæº–ã§ã™ã€‚
  * **Intercept** = å›ºå®šåŠ¹æœã®åŸºæº–ãƒ¬ãƒ™ãƒ« (Loc\_A) ã«ãŠã‘ã‚‹å¹³å‡å€¤ã®æ¨å®šå€¤ã€‚

<!-- end list -->

```{r check_intercept}
# å›ºå®šåŠ¹æœã®è¡¨ç¤º
fixef(model_tkw)
```

# 3\. å›ºå®šåŠ¹æœï¼ˆFixed Effectsï¼‰

å ´æ‰€ (Location) ã«ã‚ˆã‚‹å¹³å‡çš„ãªã‚ºãƒ¬ã‚’è¡¨ã—ã¾ã™ã€‚

  * `(Intercept)`: Loc\_A ã®å¹³å‡
  * `LocationLoc_B`: Loc\_A ã«å¯¾ã™ã‚‹ Loc\_B ã®å·®
  * `LocationLoc_C`: Loc\_A ã«å¯¾ã™ã‚‹ Loc\_C ã®å·®

**é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ**:
å›ºå®šåŠ¹æœã¯ã€Œç’°å¢ƒã®å·®ã€ã§ã‚ã‚Šã€å“ç¨®ã®èƒ½åŠ›ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚å“ç¨®é¸æŠœã®ãŸã‚ã®èƒ½åŠ›å€¤è¨ˆç®—ï¼ˆBLUEè¨ˆç®—ï¼‰ã«ãŠã„ã¦ã¯ã€ã“ã‚Œã‚‰ã¯\*\*è£œæ­£ï¼ˆé™¤å¤–ï¼‰\*\*ã•ã‚Œã‚‹ã¹ãè¦ç´ ã§ã™ã€‚

# 4\. ãƒ©ãƒ³ãƒ€ãƒ åŠ¹æœï¼ˆRandom Effectsï¼‰

å„å“ç¨® (Genotype) ãŒã€å…¨ä½“ã®å¹³å‡ã‹ã‚‰ã€Œã©ã‚Œãã‚‰ã„å„ªã‚Œã¦ã„ã‚‹ã‹/åŠ£ã£ã¦ã„ã‚‹ã‹ã€ã‚’è¡¨ã™åå·®ã§ã™ã€‚ã“ã‚Œã‚’çµ±è¨ˆå­¦çš„ã«ã¯ **BLUP (Best Linear Unbiased Prediction)** ã¨å‘¼ã³ã¾ã™ã€‚

```{r extract_ranef}
# ãƒ©ãƒ³ãƒ€ãƒ åŠ¹æœã®æŠ½å‡º
ranef(model_tkw)$Genotype %>% head()
```

  * æ­£ã®å€¤ï¼šå¹³å‡ã‚ˆã‚Šé«˜ã„èƒ½åŠ›ã‚’æŒã¤
  * è² ã®å€¤ï¼šå¹³å‡ã‚ˆã‚Šä½ã„èƒ½åŠ›ã‚’æŒã¤

# 5\. BLUE (Best Linear Unbiased Estimate) ã®è¨ˆç®—

ã“ã“ã§ã¯ã€ç’°å¢ƒå·®ã‚’è£œæ­£ã—ãŸã€Œç´”ç²‹ãªå“ç¨®ã®èƒ½åŠ›å€¤ï¼ˆæ¨å®šå€¤ï¼‰ã€ã‚’è¨ˆç®—ã—ã¾ã™ã€‚
ä¸€èˆ¬çš„ã«è‚²ç¨®ã®æ–‡è„ˆã§ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«è¨ˆç®—ã—ã¾ã™ã€‚

$$
\text{Predicted Value} = \text{Intercept (åŸºæº–)} + \text{Random Effect (å“ç¨®ã®ã‚ºãƒ¬)}
$$

> **è£œè¶³ï¼ˆç”¨èªã®ç²¾æŸ»ï¼‰**:
> çµ±è¨ˆå­¦çš„ã«å³å¯†ã«è¨€ã†ã¨ã€ã€ŒBLUEã€ã¯å›ºå®šåŠ¹æœã®æ¨å®šå€¤ã‚’æŒ‡ã—ã€ãƒ©ãƒ³ãƒ€ãƒ åŠ¹æœã¯ã€ŒBLUPã€ã¨å‘¼ã³ã¾ã™ã€‚
> ã“ã“ã§æ±‚ã‚ã‚ˆã†ã¨ã—ã¦ã„ã‚‹ã€ŒIntercept + Random Effectã€ã¯ã€**ã€Œæ¡ä»¶ä»˜ãå¹³å‡ (Conditional Mean)ã€** ã‚„ **ã€Œéºä¼å­å‹å€¤ (Genotypic Value)ã€** ã¨å‘¼ã°ã‚Œã‚‹ã“ã¨ãŒå¤šã„ã§ã™ãŒã€å®Ÿå‹™ä¸Šã“ã‚Œã‚’BLUEã¨å‘¼ã¶æ…£ç¿’ã‚‚ã‚ã‚‹ãŸã‚ã€ã“ã“ã§ã¯ã‚³ãƒ¼ãƒ‰ã®æ„å›³ã«åˆã‚ã›ã¦è¨ˆç®—ã‚’é€²ã‚ã¾ã™ã€‚

# 6\. å®Ÿéš›ã®è¨ˆç®—ã‚¹ãƒ†ãƒƒãƒ—

å®Ÿéš›ã«ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ æ“ä½œã‚’è¡Œã£ã¦ã€å“ç¨®ã”ã¨ã®å€¤ã‚’ç®—å‡ºã—ã¾ã™ã€‚

### â‘  å›ºå®šåŠ¹æœã®åŸºæº–ï¼ˆInterceptï¼‰ã®æŠ½å‡º

```{r step1_intercept}
# å›ºå®šåŠ¹æœã®ãƒ†ãƒ¼ãƒ–ãƒ«åŒ–
fixed_tkw <- fixef(model_tkw) %>%
  as.data.frame() %>%
  rownames_to_column("Term") %>%
  rename(Fixed_Estimate = ".")

# Interceptã®å€¤ã ã‘ã‚’å–ã‚Šå‡ºã™
intercept_value <- fixed_tkw %>% 
  filter(Term == "(Intercept)") %>% 
  pull(Fixed_Estimate)

print(paste("Intercept (åŸºæº–å¹³å‡):", round(intercept_value, 2)))
```

### â‘¡ ãƒ©ãƒ³ãƒ€ãƒ åŠ¹æœã®æŠ½å‡º

```{r step2_ranef}
random_tkw <- ranef(model_tkw)$Genotype %>%
  as.data.frame() %>%
  rownames_to_column("Genotype") %>%
  rename(Random_Effect = `(Intercept)`)

head(random_tkw)
```

### â‘¢ BLUEï¼ˆå“ç¨®èƒ½åŠ›å€¤ï¼‰ã®è¨ˆç®—ã¨å¯è¦–åŒ–

```{r step3_calc_blue}
# è¨ˆç®—
blue_tkw <- random_tkw %>%
  mutate(
    Intercept = intercept_value,
    BLUE_TKW = Intercept + Random_Effect # åŸºæº– + ãã®å“ç¨®ã®åå·®
  ) %>%
  arrange(desc(BLUE_TKW)) # é«˜ã„é †ã«ä¸¦ã¹æ›¿ãˆ

# ä¸Šä½5å“ç¨®ã‚’è¡¨ç¤º
head(blue_tkw, 5)
```

### â‘£ çµæœã®å¯è¦–åŒ–ï¼ˆç†è§£ã‚’åŠ©ã‘ã‚‹å›³ï¼‰

è¨ˆç®—ã•ã‚ŒãŸã€Œå“ç¨®èƒ½åŠ›å€¤ (BLUE\_TKW)ã€ã¨ã€ç”Ÿã®ãƒ‡ãƒ¼ã‚¿ï¼ˆå¹³å‡å€¤ï¼‰ã®é•ã„ã‚’å›³ç¤ºã—ã¾ã™ã€‚LMMã‚’ä½¿ã†ã“ã¨ã§ã€ãƒ‡ãƒ¼ã‚¿ã®ãƒãƒ©ã¤ãï¼ˆãƒã‚¤ã‚ºï¼‰ãŒã©ã®ã‚ˆã†ã«å‡¦ç†ã•ã‚ŒãŸã‹ãŒã‚ã‹ã‚Šã¾ã™ã€‚

```{r visualize, fig.height=6, fig.width=8}
# ç”Ÿãƒ‡ãƒ¼ã‚¿ã®å“ç¨®ã”ã¨ã®å¹³å‡ã‚’è¨ˆç®—
raw_means <- df %>%
  group_by(Genotype) %>%
  summarise(Raw_Mean = mean(SPno))

# çµåˆ
plot_data <- left_join(blue_tkw, raw_means, by = "Genotype")

# ãƒ—ãƒ­ãƒƒãƒˆ
ggplot(plot_data) +
  # ç”Ÿãƒ‡ãƒ¼ã‚¿ã®å¹³å‡ï¼ˆã‚°ãƒ¬ãƒ¼ï¼‰
  geom_point(aes(x = reorder(Genotype, BLUE_TKW), y = Raw_Mean, color = "Raw Mean"), size = 3, alpha = 0.6) +
  # LMMã«ã‚ˆã‚‹æ¨å®šå€¤ï¼ˆèµ¤ï¼‰
  geom_point(aes(x = reorder(Genotype, BLUE_TKW), y = BLUE_TKW, color = "LMM Estimate (BLUE)"), size = 3) +
  # ãã®å·®ã‚’ç·šã§çµã¶
  geom_segment(aes(x = reorder(Genotype, BLUE_TKW), xend = reorder(Genotype, BLUE_TKW),
                   y = Raw_Mean, yend = BLUE_TKW), color = "gray", linetype = "dashed") +
  coord_flip() +
  labs(
    title = "ç”Ÿãƒ‡ãƒ¼ã‚¿ã®å¹³å‡ vs LMMã«ã‚ˆã‚‹æ¨å®šå€¤ (ç¸®å°æ¨å®š)",
    subtitle = "LMMã¯æ¥µç«¯ãªå€¤ã‚’å…¨ä½“å¹³å‡(Intercept)ã®æ–¹å‘ã«å¼•ãå¯„ã›ã‚‹ï¼ˆç¸®å°æ¨å®šï¼‰æ€§è³ªãŒã‚ã‚Šã¾ã™",
    x = "Genotype",
    y = "SPno Value",
    color = "Legend"
  ) +
  theme_minimal() +
  scale_color_manual(values = c("LMM Estimate (BLUE)" = "red", "Raw Mean" = "gray50"))
```

**å›³ã®è§£èª¬**:

  * **ã‚°ãƒ¬ãƒ¼ã®ç‚¹**: å˜ç´”ãªç®—è¡“å¹³å‡ã€‚ç’°å¢ƒã®åã‚Šã‚„ã€ãƒ‡ãƒ¼ã‚¿æ•°ãŒå°‘ãªã„å ´åˆã®å¶ç„¶ã®èª¤å·®ã‚’å«ã‚“ã§ã„ã¾ã™ã€‚
  * **èµ¤ã®ç‚¹**: LMMã§è¨ˆç®—ã—ãŸèƒ½åŠ›å€¤ã€‚
  * **ç¸®å°æ¨å®š (Shrinkage)**: LMMã«ã¯ã€ãƒ‡ãƒ¼ã‚¿ãŒå°‘ãªã„å ´åˆã‚„æ¥µç«¯ãªå€¤ãŒå‡ºãŸå ´åˆã«ã€å…¨ä½“å¹³å‡ï¼ˆInterceptï¼‰ã®æ–¹ã¸å€¤ã‚’å¼•ãå¯„ã›ã‚‹æ€§è³ªãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€å¶ç„¶ã«ã‚ˆã‚‹éå¤§è©•ä¾¡ãƒ»éå°è©•ä¾¡ã‚’é˜²ãã€ã‚ˆã‚Šã€ŒçœŸã®å®ŸåŠ›ã€ã«è¿‘ã„å€¤ã‚’æ¨å®šã—ã¾ã™ã€‚

# 7\. REML = TRUE ã®æ„å‘³

ãƒ¢ãƒ‡ãƒ«ä½œæˆæ™‚ã« `REML = TRUE`ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰ã¨ãªã£ã¦ã„ã‚‹ã“ã¨ã®é‡è¦æ€§ã«ã¤ã„ã¦ã€‚

  * **ML (Maximum Likelihood)**: åˆ†æ•£ã‚’æ¨å®šã™ã‚‹éš›ã€ã‚µãƒ³ãƒ—ãƒ«æ•° $n$ ã§å‰²ã‚‹ï¼ˆå°‘ã—å°ã•ãè¦‹ç©ã‚‚ã£ã¦ã—ã¾ã†ï¼åã‚ŠãŒã‚ã‚‹ï¼‰ã€‚
  * **REML (Restricted ML)**: å›ºå®šåŠ¹æœã®è‡ªç”±åº¦ã‚’è€ƒæ…®ã—ã¦ $n-p$ ã§å‰²ã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼ˆä¸ååˆ†æ•£ã«è¿‘ã„ï¼‰ã€‚

**çµè«–**:
åˆ†æ•£æˆåˆ†ï¼ˆGenotypeã®åˆ†æ•£ãªã©ï¼‰ã‚’æ­£ç¢ºã«çŸ¥ã‚ŠãŸã„å ´åˆã‚„ã€æœ€çµ‚çš„ãªãƒ¢ãƒ‡ãƒ«æ¨å®šã«ã¯ **REML** ãŒé©ã—ã¦ã„ã¾ã™ã€‚ãƒ¢ãƒ‡ãƒ«åŒå£«ã‚’æ¯”è¼ƒã™ã‚‹ï¼ˆå°¤åº¦æ¯”æ¤œå®šãªã©ï¼‰å ´åˆã¯ã€ä¸€æ™‚çš„ã« `REML = FALSE` ã«ã™ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚

# 8\. ã¾ã¨ã‚

1.  **Intercept** ã¯åŸºæº–ã¨ãªã‚‹ç’°å¢ƒï¼ˆå›ºå®šåŠ¹æœã®åŸºæº–ï¼‰ã§ã®å¹³å‡å€¤ã€‚
2.  **å›ºå®šåŠ¹æœ** ã¯ç’°å¢ƒã«ã‚ˆã‚‹ãƒ—ãƒ©ã‚¹ãƒã‚¤ãƒŠã‚¹ã®å½±éŸ¿ï¼ˆå“ç¨®é¸æŠœã«ã¯ä¸è¦ãªæƒ…å ±ï¼‰ã€‚
3.  **ãƒ©ãƒ³ãƒ€ãƒ åŠ¹æœ** ã¯å“ç¨®ã”ã¨ã®å›ºæœ‰ã®èƒ½åŠ›ï¼ˆå¹³å‡ã‹ã‚‰ã®åå·®ï¼‰ã€‚
4.  **BLUE (ã¾ãŸã¯Predicted Value)** = Intercept + ãƒ©ãƒ³ãƒ€ãƒ åŠ¹æœã€‚ã“ã‚ŒãŒç’°å¢ƒè£œæ­£æ¸ˆã¿ã®å“ç¨®èƒ½åŠ›ã€‚
5.  **LMMã®åˆ©ç‚¹**: ãƒ‡ãƒ¼ã‚¿æ¬ æã«å¼·ãã€æ¥µç«¯ãªå€¤ã‚’è£œæ­£ï¼ˆç¸®å°æ¨å®šï¼‰ã—ã¦ãã‚Œã‚‹ãŸã‚ã€å˜ç´”å¹³å‡ã‚ˆã‚Šã‚‚ä¿¡é ¼æ€§ãŒé«˜ã„ã€‚

<!-- end list -->

```

